<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<link rel="stylesheet" href="css/main.css">
	<script src="js/main.js"></script>
</head>
<body>
	<ul>
		<li><a href="/" class="back">to home</a></li>
		<li class="list-item"><a href="https://confluence.ontrq.com/pages/viewpage.action?spaceKey=KB&title=Easy+level+-+native+JS" target="_blank">Easy level - native JS</a></li>
	</ul>

	<div class="wrapper">
		<textarea class="input" name="message" id="js-message" cols="30" rows="10" spellcheck="false"></textarea>
		<p>Symbols total: <b id="js-message-left-total">0</b>, left: <b id="js-message-left-symbols">0</b></p>
	</div>

	<script>
		
		var TextCounter = {
			maxChar: 140,
			textArea: null,
			textAreaTotal: null,
			textAreaLeft: null,
			init: function() {
				this.textArea = document.querySelector('#js-message');
				this.textAreaTotal = document.querySelector('#js-message-left-total');
				this.textAreaLeft = document.querySelector('#js-message-left-symbols');
				
				this.events();
			},
			
			events: function() {
				this.counterTotal();
				this.listener();
				// this.textArea.addEventListener('keypress', this.listener);
				// this.textArea.addEventListener('keyup', this.listener);
			},

			counterTotal: function() {
				var countChar = this.textArea.value.length;
				var countCharLeft = this.maxChar - countChar;

				this.textAreaTotal.innerHTML = countChar;
				this.textAreaLeft.innerHTML = countCharLeft;
				return countCharLeft;
			},

			listener: function() {
				var self = this;
				
				this.textArea.onkeyup = function (event) {
					var count = self.counterTotal();
					var k = event.keyCode;

					var a = self.textArea.value;
					console.log();

					if (count <= 0) {
						if (
							k == 8 || 
							k == 35 || 
							k == 36 || 
							k == 46 || 
							k == 45 || 
							k == 37 || 
							k == 38 || 
							k == 39 || 
							k == 40
							) return;
							self.textArea.value = self.textArea.value.substring(0, self.maxChar-1);
					}
				}
			}
			
		};

		TextCounter.init();

	</script>

</body>
</html>