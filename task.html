<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<link rel="stylesheet" href="css/main.css">
	<script src="js/main.js"></script>
</head>
<body>
	<ul>
		<li><a href="/" class="back">to home</a></li>
		<li class="list-item"><a href="https://confluence.ontrq.com/pages/viewpage.action?spaceKey=KB&title=Easy+level+-+native+JS" target="_blank">Easy level - native JS</a></li>
	</ul>

	<div class="wrapper">
		<textarea class="input" name="message" id="js-message" cols="30" rows="10" spellcheck="false"></textarea>
		<p>Symbols total: <b id="js-message-left-total">0</b>, left: <b id="js-message-left-symbols">0</b></p>
	</div>

	<script>
		
		var TextCounter = {
			maxChar: 140,
			textArea: null,
			textAreaTotal: null,
			textAreaLeft: null,
			init: function() {
				this.textArea = document.querySelector('#js-message');
				this.textAreaTotal = document.querySelector('#js-message-left-total');
				this.textAreaLeft = document.querySelector('#js-message-left-symbols');
				
				this.events();
			},
			
			events: function() {
				this.putCounter();
				this.textArea.addEventListener('keyup', this.putCounter.bind(this));
				this.textArea.addEventListener('keydown', this.validateCount.bind(this));
			},

			listener: function() {
				var countChar = this.textArea.value.length;
				var countCharLeft = this.maxChar - countChar;
				return {
					countChar: countChar,
					countCharLeft: countCharLeft
				};
			},

			putCounter: function () {
				var total = this.listener();

				this.textAreaTotal.innerHTML = total.countChar;
				this.textAreaLeft.innerHTML = total.countCharLeft;
			},

			validateCount: function(event) {
					var k = event.keyCode;
					var total = this.listener();
					
					if (total.countCharLeft <= 0) {
						if (k == 8 || (k >= 35 && k <= 40) || k == 45 || k == 46) return;
							// this.textArea.value = this.textArea.value.substring(0, this.maxChar - 1);
							event.preventDefault();
					}
			}
			
		};

		TextCounter.init();

	</script>

</body>
</html>